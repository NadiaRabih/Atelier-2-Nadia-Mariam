<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Signup - MiniBlog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-4">

  <h3 class="text-center mb-4">Créer un compte</h3>

  <div class="card p-3">
    <h5>Informations du compte</h5>
    <input id="su-name" class="form-control mb-2" placeholder="Nom">
    <input id="su-email" class="form-control mb-2" placeholder="Email">
    <input id="su-pass" type="password" class="form-control mb-2" placeholder="Mot de passe">
    <button class="btn btn-primary w-100 mt-2" onclick="signup()">Créer mon compte</button>
  </div>

  <p class="text-center mt-3">
    Déjà un compte ? <a href="login.html">Se connecter</a>
  </p>

</div>

<script>

class User {
  constructor(name, email, password){
    this.name = name;
    this.email = email;
    this.password = password;
  }


  toJSON(){
    return { name: this.name, email: this.email, password: this.password };
  }


  static fromJSON(obj){
    return new User(obj.name, obj.email, obj.password);
  }
}

function signup(){
  const name = document.getElementById("su-name").value;
  const email = document.getElementById("su-email").value;
  const pass = document.getElementById("su-pass").value;

  if(!name || !email || !pass){
    alert("Veuillez remplir tous les champs");
    return;
  }


  let users = JSON.parse(localStorage.getItem("users") || "[]");

 
  for(let u of users){
    if(User.fromJSON(u).email === email){
      alert("Email déjà utilisé !");
      return;
    }
  }


  const newUser = new User(name, email, pass);
  users.push(newUser.toJSON());
  localStorage.setItem("users", JSON.stringify(users));

  alert("Compte créé avec succès ! Vous pouvez maintenant vous connecter.");
  window.location.href = "login.html";
}
</script>
</body>
</html>
