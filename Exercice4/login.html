<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Login - MiniBlog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">

  <h3 class="text-center mb-4">Se connecter</h3>

  <div class="card p-3">
    <h5>Connexion</h5>
    <input id="lo-email" class="form-control mb-2" placeholder="Email">
    <input id="lo-pass" type="password" class="form-control mb-2" placeholder="Mot de passe">
    <button class="btn btn-success w-100 mt-2" onclick="login()">Connexion</button>
  </div>

  <p class="text-center mt-3">
    Pas encore de compte ? <a href="signup.html">Créer un compte</a>
  </p>

</div>

<script>

class User {
  constructor(name, email, password){
    this.name = name;
    this.email = email;
    this.password = password;
  }

  toJSON(){ return { name: this.name, email: this.email, password: this.password }; }
  static fromJSON(obj){ return new User(obj.name, obj.email, obj.password); }
}


function login(){
  const email = document.getElementById("lo-email").value;
  const pass = document.getElementById("lo-pass").value;

  if(!email || !pass){
    alert("Veuillez remplir tous les champs");
    return;
  }

 
  const users = JSON.parse(localStorage.getItem("users") || "[]");

  for(let u of users){
    const user = User.fromJSON(u);
    if(user.email === email && user.password === pass){
      alert("Connexion réussie !");
      window.location.href = "app.html?user=" + encodeURIComponent(JSON.stringify(user));
      return;
    }
  }

  alert("Email ou mot de passe incorrect");
}
</script>
</body>
</html>
